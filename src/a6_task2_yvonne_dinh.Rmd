---
title: "Task 2"
author: "Yvonne Dinh"
date: "12/7/2020"
output: html_document
---

```{r setup, message=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(broom)
library(tibble)
library(lubridate)
library(here)
library(janitor)
library(kableExtra)
```

## Political and Environmental Self-Identification

### Introduction: This analysis uses survey data conducted by Chelsea Batavia and Andrews Forest LTER that explores the "influence on charitable giving for conservation" in August 2017. It explores the association between survey respondents' political affiliation and whether or not they self-identify as an environmentalist. 

```{r, echo=FALSE, warnings=FALSE, include=FALSE}
#read in data
survey=read.csv(here("data","conservation_survey.csv")) %>% 
  clean_names()

#keep only the 'ENV_ID' and 'POL_OR' variables
survey_simple=survey %>% 
  select(env_id, pol_or)

#add a new column of political parties and get rid of other political affiliations
survey_simple=survey_simple %>% 
  mutate(party=case_when(
    pol_or %in% c("1", "2", "3") ~ "Conservative",
    pol_or %in% c("5", "6", "7") ~ "Liberal")) %>% 
  mutate(envi=case_when(
    env_id %in% c("1") ~ "Yes",
    env_id %in% c("2") ~ "No",
    env_id %in% c("3") ~ "Unsure")) %>% 
  filter(!is.na(party))
```

Table 1: Counts and proportions of liberal and conservative survey respondents to the statement "I consider myself an environmentalist."
```{r, warnings = FALSE, echo = FALSE}
#create a table that shows counts and proportions of survey results
survey_counts=survey_simple %>% 
  tabyl(party, envi)

survey_table=survey_simple %>%
  tabyl(party, envi) %>% 
  adorn_percentages() %>% 
  adorn_pct_formatting(digits=2) %>% 
  adorn_ns() %>% 
  rename ("Political Party" = party) %>% 
  select(1,4,2,3)

kbl(survey_table) %>% 
  kable_material(c("striped", "hover"))

```

```{r}
#convert counts table to a contingency table and preform a chi-square test for independence to answer: is there an association between political affiliation and environmentalism?

#convert counts table to a contingency table
survey_ct=survey_counts %>% 
  column_to_rownames(var="party")

#preform a chi-square test
survey_chisq=chisq.test(survey_ct)
survey_tidy=tidy(survey_chisq)

#is there an association between political affiliation and environmentalism? the p-squared value is significant, so we reject the null hypothesis that there is not independence between the two values. 

```

